version: "2"
dynamodb-pipeline:
  source:
    dynamodb:
      acknowledgments: true
      tables:
        - table_arn: "DYNAMODB_TABLE_ARN"   # Will be replaced dynamically by CDK
          stream:
            start_position: "LATEST"
          export:
            s3_bucket: "BUCKET_NAME"       # Will be replaced dynamically by CDK
            s3_region: "REGION_NAME"       # Will be replaced dynamically by CDK
            s3_prefix: "opensearch-ddb-export/"
      aws:
        sts_role_arn: "STS_ROLE_ARN"       # Will be replaced dynamically by CDK
        region: "REGION_NAME"              # Will be replaced dynamically by CDK
  sink:
    - opensearch:
        hosts:
          [
            "https://OpenSearch_DOMAIN"  # Will be replaced dynamically by CDK
          ]
        index: "opensearch-ddb-index"
        index_type: custom
        document_id: "${getMetadata(\"primary_key\")}"
        action: "${getMetadata(\"opensearch_action\")}"
        document_version: "${getMetadata(\"document_version\")}"
        document_version_type: "external"
        aws:
          sts_role_arn: "STS_ROLE_ARN"   # Will be replaced dynamically by CDK
          region: "REGION_NAME"
